<!DOCTYPE html>
<html>
    <head>
        <meta charset=UTF-8 />
        <link rel="stylesheet" type="text/css" href="styles.css"/>
    </head>
    <body>
        <script src="js/three.js"></script>
        <script src="js/three.min.js"></script>
        <script src="js/OrbitControls.js"></script>
        <script src="js/GLTFLoader.js"></script>
        <script>
            
            (function(){var script=document.createElement('script');
            script.onload=function(){var stats=new Stats();document.body.appendChild(stats.dom);
                requestAnimationFrame(function loop(){stats.update();requestAnimationFrame(loop)});};
                script.src='//mrdoob.github.io/stats.js/build/stats.min.js';document.head.appendChild(script);})()


            let scene, camera, renderer, controls, model, hemiLight, spotLight;
            function init(){

                renderer = new THREE.WebGLRenderer({antialias: true});
                renderer.toneMapping = THREE.ReinhardToneMapping;
                renderer.toneMappingExposure = 2.3;
                renderer.shadowMap.enabled = true;
                renderer.setSize(window.innerWidth, window.innerHeight);
                document.body.appendChild(renderer.domElement);

                scene = new THREE.Scene();
                scene.background = new THREE.Color(0x000000);
    

                camera = new THREE.PerspectiveCamera(60,window.innerWidth/window.innerHeight,1,5000);
                camera.position.set(0,25,25);

                controls = new THREE.OrbitControls(camera,renderer.domElement);
                controls.addEventListener('change', renderer);

                hemiLight = new THREE.HemisphereLight(0xffeeb1, 0x080820, 4);
                scene.add(hemiLight);

                var light = new THREE.DirectionalLight(0xdfebff, 1);
                light.position.set(50,200,10);
                light.position.multiplyScalar( 1.3 );
                light.shadow.mapSize.width = 1024;
                light.shadow.mapSize.height = 1024;
                light.castShadow = true;
                scene.add( light );

                var light2 = new THREE.DirectionalLight( 0xffffff );
                light2.position.set(1,1,1);
                light2.castShadow = false;
                scene.add( light2 );

                spotLight = new THREE.SpotLight(0xffffff,4);
                spotLight.position.set(-50,50,50);
                spotLight.castShadow = true;
                spotLight.shadow.bias = -0.0001;
                spotLight.shadow.mapSize.width = 1024*4;
                spotLight.shadow.mapSize.height = 1024*4;
                scene.add( spotLight );


                //scene.add( new THREE.AxesHelper(500));

                new THREE.GLTFLoader().load('model/scene.gltf', result => {
                    model = result.scene.children[0]; 
                    //model.position.set(0,-5,-25);
                    model.traverse(n => { 
                        if ( n.isMesh ) 
                        {
                            n.castShadow = true; 
                            n.receiveShadow = true;
                            if(n.material.map) n.material.map.anisotropy = 16; 
                        }});
                    model.scale.set(0.5, 0.5, 0.5);
                    scene.add(model);
                    animate();
                }); 
            }
            function animate(){
                renderer.render(scene,camera);
                spotLight.position.set(
                    camera.position.x + 10,
                    camera.position.y + 10,
                    camera.position.z + 10,
                );
                requestAnimationFrame(animate);
            }
            init();
        </script>
    </body>
</html>